const join = document.getElementById('joinDiscordLink'); if (join) join.href='https://discord.gg/NCYbWRjrU';
document.querySelectorAll('[data-post]').forEach(el=>{el.addEventListener('click',e=>{const t=document.querySelector('#request-form');if(t){e.preventDefault();t.scrollIntoView({behavior:'smooth',block:'start'});const f=t.querySelector('input, textarea, select, button');if(f)setTimeout(()=>f.focus(),200);}})});
const y=document.getElementById('y');if(y)y.textContent=new Date().getFullYear();
const form=document.getElementById('requestForm');if(form){form.addEventListener('submit',async e=>{e.preventDefault();const b=form.querySelector('[type="submit"]');const o=b?.textContent||'Submit';if(b){b.disabled=true;b.textContent='Sending...';}try{const fd=new FormData(form);const endpoint=form.dataset.endpoint||'api/submit';const r=await fetch(endpoint,{method:'POST',body:fd});const tx=await r.text();if(!r.ok)throw new Error(tx||'Server error');form.reset();alert('✅ Request sent! Check #post-a-request on Discord.');}catch(err){console.error(err);alert('❌ Could not send request. '+err.message);}finally{if(b){b.disabled=false;b.textContent=o;}}});}